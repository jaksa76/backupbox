<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#4f46e5" />
  <meta name="description" content="A powerful PWA for background file processing and backups." />
  <link rel="manifest" href="manifest.json" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="src/styles.css" />
  <title>BackupBox | Background File Recovery</title>
</head>

<body>
  <div class="container">
    <header>
      <div class="logo-wrapper">
        <img src="icons/icon-192.svg" alt="logo" />
      </div>
      <h1>BackupBox</h1>
      <p class="description">Automatic cloud backup with Fleabox</p>
    </header>

    <main>
      <section class="status-card" aria-live="polite">
        <span class="status-label">Current Status</span>
        <p id="status">Initializing system...</p>
        <div class="progress-container" id="progressWrapper">
          <div class="progress-bar" id="progressBar"></div>
        </div>
      </section>

      <div class="controls">
        <button id="pickFolder" class="btn btn-primary btn-full">
          <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M12 4v16m8-8H4"></path>
          </svg>
          Add Source Folder
        </button>

        <button id="startWorker" class="btn btn-secondary" disabled>
          <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
          </svg>
          Start Cloud Backup
        </button>

        <button id="stopWorker" class="btn btn-danger" disabled>
          <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            <path d="M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1H10a1 1 0 01-1-1v-4z"></path>
          </svg>
          Stop
        </button>
      </div>

      <div id="folderList" class="folder-list">
        <!-- Folders will be added here dynamically -->
      </div>

      <div class="stats-grid">
        <div class="stat-item">
          <span class="stat-value" id="fileCount">-</span>
          <span class="stat-label">Backed Up</span>
        </div>
        <div class="stat-item">
          <span class="stat-value" id="lastSync">Never</span>
          <span class="stat-label">Last Backup</span>
        </div>
      </div>

      <div class="tip">
        <strong>Pro Tip:</strong> BackupBox automatically rescans and uploads changed files every 5 minutes. Files are stored on the Fleabox server with the same directory structure.
      </div>
    </main>
  </div>

  <footer id="footer" class="footer" style="cursor: pointer;" title="Click to toggle debug panel">
    <div><span class="dot online"></span> SW Active</div>
    <div>v1.0.0</div>
  </footer>

  <!-- Debug Panel for Mobile Debugging -->
  <div id="debugPanel" style="display: none; position: fixed; bottom: 0; left: 0; right: 0; max-height: 40vh; overflow-y: auto; background: #1a1a1a; border-top: 2px solid var(--primary); padding: 10px; font-family: monospace; font-size: 11px; z-index: 1000;">
    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
      <strong style="color: var(--primary);">Debug Log</strong>
      <div>
        <button id="forceReload" style="background: #ff9900; color: white; border: none; padding: 2px 8px; border-radius: 3px; cursor: pointer; margin-right: 5px;">Force Reload</button>
        <button id="clearDebug" style="background: var(--danger); color: white; border: none; padding: 2px 8px; border-radius: 3px; cursor: pointer;">Clear</button>
      </div>
    </div>
    <div id="debugLog"></div>
  </div>
  <script type="module" src="src/app.js"></script>
</body>

</html>